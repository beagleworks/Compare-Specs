# 要件定義書

## 概要

紙の振替伝票への手書き作業を置き換えるWebアプリケーションです。経費支払い時に領収書が入手できない場合（例：業務中の電車代の立て替え）に、振替伝票を電子的に作成・管理できます。

## 要件

### 要件1

**ユーザーストーリー:** 経理担当者として、振替伝票を電子的に作成したい。これにより手書き作業を効率化できる。

#### 受入基準

1. WHEN ユーザーが振替伝票作成画面にアクセスした時 THEN システムは日付、借方科目、貸方科目、金額、摘要、ナンバーの入力フィールドを表示する
2. WHEN ユーザーが借方科目または貸方科目を選択する時 THEN システムは一般的な勘定科目のプルダウンリストと「その他」オプションを提供する
3. WHEN ユーザーが「その他」を選択した時 THEN システムは自由入力可能なテキストフィールドを表示する
4. WHEN ユーザーが金額を入力した時 THEN システムは借方合計と貸方合計を自動計算して表示する

### 要件2

**ユーザーストーリー:** 経理担当者として、作成した振替伝票の借方・貸方の合計が一致していることを確認したい。これにより会計上の整合性を保てる。

#### 受入基準

1. WHEN 借方合計と貸方合計が一致していない時 THEN システムはエラーメッセージを表示し保存を無効にする
2. WHEN 借方合計と貸方合計が一致している時 THEN システムは保存ボタンを有効にする
3. WHEN ユーザーが金額を変更した時 THEN システムはリアルタイムで合計金額の整合性をチェックする

### 要件3

**ユーザーストーリー:** 経理担当者として、作成した振替伝票をPDF化して保存・印刷したい。これにより物理的な書類として管理できる。

#### 受入基準

1. WHEN ユーザーがPDF出力ボタンをクリックした時 THEN システムは振替伝票をPDF形式で生成する
2. WHEN PDFが生成された時 THEN システムはダウンロードまたは印刷オプションを提供する
3. WHEN PDFを生成する時 THEN システムは標準的な振替伝票のレイアウトでフォーマットする

### 要件4

**ユーザーストーリー:** 経理担当者として、入力した振替伝票データを永続化したい。これにより後から参照・修正できる。

#### 受入基準

1. WHEN ユーザーが振替伝票を保存した時 THEN システムはデータベースに全ての入力情報を記録する
2. WHEN データが保存された時 THEN システムは一意のIDを生成して振替伝票に割り当てる
3. WHEN 保存が完了した時 THEN システムは成功メッセージを表示する
4. WHEN データベースエラーが発生した時 THEN システムはエラーメッセージを表示し再試行オプションを提供する

### 要件5

**ユーザーストーリー:** 単独利用者として、他者による不正アクセスを防ぎたい。これによりデータの機密性を保てる。

#### 受入基準

1. WHEN ユーザーがアプリケーションにアクセスした時 THEN システムはパスワード入力画面を表示する
2. WHEN 正しいパスワードが入力された時 THEN システムはメイン機能へのアクセスを許可する
3. WHEN 間違ったパスワードが入力された時 THEN システムはエラーメッセージを表示しアクセスを拒否する
4. WHEN ユーザーがパスワードを設定・変更したい時 THEN システムは設定画面を提供する

### 要件6

**ユーザーストーリー:** 経理担当者として、過去に作成した振替伝票を検索・閲覧したい。これにより履歴管理ができる。

#### 受入基準

1. WHEN ユーザーが振替伝票一覧画面にアクセスした時 THEN システムは保存済みの振替伝票リストを表示する
2. WHEN ユーザーが日付範囲で検索した時 THEN システムは該当期間の振替伝票を絞り込み表示する
3. WHEN ユーザーが特定の振替伝票を選択した時 THEN システムは詳細情報を表示する
4. WHEN ユーザーが振替伝票を編集したい時 THEN システムは編集可能な状態で表示する